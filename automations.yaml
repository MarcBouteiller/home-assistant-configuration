- id: coucher_de_soleil
  alias: Coucher de soleil
  trigger:
  - event: sunset
    offset: 00:20:00
    platform: sun
  action:
  - entity_id: group.all_covers
    service: cover.close_cover

- id: veilleuse
  alias: Veilleuse
  trigger:
    platform: state
    entity_id: binary_sensor.fibaro_system_fgms001_motion_sensor_sensor
    from: 'off'
    to: 'on'
  condition:
  - condition: state
    entity_id: input_boolean.night_mode
    state: 'on'
  - condition: state
    entity_id: light.salon
    state: 'off'
  action:
  - service: light.turn_on
    data:
      entity_id: light.salon
      brightness: 10
  - delay: 00:02:30
  - service: light.turn_off
    data:
      entity_id: light.salon

- id: night_mode_on
  alias: Mode nuit
  trigger:
    platform: state
    entity_id: input_boolean.night_mode
    to: 'on'
  action:
  - service: light.turn_off
    data:
      entity_id: light.salon
  - service: switch.turn_off
    data:
      entity_id: switch.neo_coolcam_power_plug_12a_switch_3

- id: night_mode_off
  alias: Lever
  trigger:
    platform: time
    at: 07:00:00
  condition:
    - condition: state
      entity_id: binary_sensor.workday_sensor
      state: 'on'
    - condition: state
      entity_id: input_boolean.holiday_mode
      state: 'off'
  action:
  - service: light.turn_on
    data:
      entity_id: light.salon
      brightness: 25
  - service: switch.turn_on
    data:
      entity_id: switch.neo_coolcam_power_plug_12a_switch_3
  - service: input_boolean.turn_off
    data:
      entity_id: input_boolean.night_mode

- id: leave_home
  alias: DÃ©part
  trigger:
    platform: zone
    entity_id: device_tracker.homeassistant_marcohonor
    zone: zone.home
    event: leave
  action:
    - service: input_boolean.turn_on
      data:
        entity_id: input_boolean.away_mode
    - service: switch.turn_on
      data:
        entity_id: switch.neo_coolcam_power_plug_12a_switch_2

- id: coming_home
  alias: Retour
  trigger:
    platform: zone
    entity_id: device_tracker.homeassistant_marcohonor
    zone: zone.home
    event: enter
  action:
    - service: input_boolean.turn_off
      data:
        entity_id: input_boolean.away_mode
    - service: switch.turn_off
      data:
        entity_id: switch.neo_coolcam_power_plug_12a_switch_2